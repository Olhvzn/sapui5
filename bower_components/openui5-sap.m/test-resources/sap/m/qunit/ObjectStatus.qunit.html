<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>ObjectStatus - sap.m</title>

<link rel="stylesheet" href="../../../../resources/sap/ui/thirdparty/qunit.css" type="text/css" media="screen">

<!-- UI5 Bootstrap -->
<script src="../shared-config.js"></script>
<script id="sap-ui-bootstrap" src="../../../../resources/sap-ui-core.js" data-sap-ui-libs="sap.m"></script>

<!-- QUnit libraries -->

<script src="../../../../resources/sap/ui/thirdparty/qunit.js"></script>
<script src="../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
<script src="../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
<script src="../../../../resources/sap/ui/thirdparty/sinon.js"></script>
<script src="../../../../resources/sap/ui/thirdparty/sinon-qunit.js"></script>

<script>
	jQuery.sap.require("sap.ui.core.IconPool");

	var eventHandler = function (oEvent) {
		assert.ok(true, "press event for status was fired");
	}

	var os1 = new sap.m.ObjectStatus("os1",{
		text : "    Contract #D1234567890     "
		});

	var os2 = new sap.m.ObjectStatus("os2",{
		icon: sap.ui.core.IconPool.getIconURI("inbox")
		});

	var os3 = new sap.m.ObjectStatus("os3",{
		text : "Update by Mary Smith",
		icon: sap.ui.core.IconPool.getIconURI("inbox")
		});


	os1.placeAt("objectStatuses");
	os2.placeAt("objectStatuses");
	os3.placeAt("objectStatuses");

	QUnit.module("Rendering All Fields");

	QUnit.test("StatusRendered", function(assert) {

		assert.notEqual(jQuery.sap.domById("os1"), null, "Object Status #1 should be rendered.");
		assert.notEqual(jQuery.sap.domById("os2"), null, "Object Status #2 should be rendered.");
		assert.notEqual(jQuery.sap.domById("os3"), null, "Object Status #3 should be rendered.");
	});

	QUnit.test("render a placeholder if _isEmpty", function(assert) {
		//arrange
		var oOS = new sap.m.ObjectStatus(),
			$OS;

		//act
		oOS.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		$OS = jQuery("#" + oOS.getId());

		//assert
		assert.equal($OS.length, 1, "rendered even though it is empty");
		assert.equal($OS.eq(0).css("display"), "none", "not visible because it is empty");

		//clean
		oOS.destroy();
	});

	/******************************************************************/

	QUnit.module("Internal API");


	var os4 = new sap.m.ObjectStatus("os4",{
		text : " \n \n  \t  \t",
		icon: " \n \n  \t  \t"
		});

	var os5 = new sap.m.ObjectStatus("os5",{
		text : " \n \n  \t  \t"
		});

	var os6 = new sap.m.ObjectStatus("os6",{
		icon: " \n \n  \t  \t"
		});

	var os7 = new sap.m.ObjectStatus("os7",{
		text : "Update by Mary Smith",
		icon: sap.ui.core.IconPool.getIconURI("inbox"),
		visible: false
		});

	QUnit.test("TestIsEmpty", function(assert) {

		assert.ok(!os1._isEmpty(), "Object Status #1 is not empty");
		assert.ok(!os2._isEmpty(), "Object Status #2 is not empty");
		assert.ok(!os3._isEmpty(), "Object Status #3 is not empty");
		assert.ok(os4._isEmpty(), "Object Status #4 is empty");
		assert.ok(os5._isEmpty(), "Object Status #5 is empty");
		assert.ok(os6._isEmpty(), "Object Status #6 is empty");
		assert.ok(os7.$().length == 0, "Object Status #7 is not rendered");
	});

	QUnit.module("Supressed invalidation");

	QUnit.test("Should not rerender the ObjectStatus if the text is changed", function(assert) {
		// Arrange
		var sTextToSet = "<script>alert(\"HAACKED\");<\/script>",
			oRenderSpy,
			oResult,
			oConstructor = { text : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setText(sTextToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oResult, oObjectStatus, "Should be able to chain");
		assert.strictEqual(oRenderSpy.callCount, 0, "Did not rerender");
		assert.ok(!/.*<script>.*/.test(oObjectStatus.$().children(".sapMObjStatusText").html()), "Did not contain a unescaped script tag");
		assert.strictEqual(oObjectStatus.getText(), sTextToSet, "Did set the non encoded string as value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should not rerender the ObjectStatus if the text is a number", function(assert) {
		// Arrange
		var iNumberToSet = 5,
			sTextToExpect = "5",
			oRenderSpy,
			oResult,
			oConstructor = { text : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setText(iNumberToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oResult, oObjectStatus, "Should be able to chain");
		assert.strictEqual(oRenderSpy.callCount, 0, "Did not rerender");
		assert.strictEqual(oObjectStatus.getText(), sTextToExpect, "Did set the number as a string as a value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should not rerender the ObjectStatus if the title is changed", function(assert) {
		// Arrange
		var sTextToSet = "<script>alert(\"HAACKED\");<\/script>",
			oRenderSpy,
			oResult,
			oConstructor = { title : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setTitle(sTextToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oResult, oObjectStatus, "Should be able to chain");
		assert.strictEqual(oRenderSpy.callCount, 0, "Did not rerender");

		assert.ok(!/.*<script>.*/.test(oObjectStatus.$().children(".sapMObjStatusTitle").html()), "Did not contain a unescaped script tag");

		var sDisplayedTitle = oObjectStatus.$().children(".sapMObjStatusTitle").text();
		assert.ok(sDisplayedTitle.indexOf(":", sDisplayedTitle.length - 1) , "Did contain a :");
		assert.strictEqual(oObjectStatus.getTitle(), sTextToSet, "Did set the non encoded string as value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should not rerender the ObjectStatus if the title is a number", function(assert) {
		// Arrange
		var iNumberToSet = 5,
			sTitleToExpect = "5",
			oRenderSpy,
			oResult,
			oConstructor = { title : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setTitle(iNumberToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oResult, oObjectStatus, "Should be able to chain");
		assert.strictEqual(oRenderSpy.callCount, 0, "Did not rerender");
		assert.ok(!/.*<script>.*/.test(oObjectStatus.$().children(".sapMObjStatusTitle").html()), "Did not contain a unescaped script tag");
		assert.strictEqual(oObjectStatus.$().children(".sapMObjStatusTitle").text(), oObjectStatus.getTitle() + ":", "Did contain a :");
		assert.strictEqual(oObjectStatus.getTitle(), sTitleToExpect, "Did set the number as a string as a value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should rerender if the new text is empty", function(assert) {
		// Arrange
		var sTextToSet = "  ",
			oRenderSpy,
			oResult,
			oConstructor = { text : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setText(sTextToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oRenderSpy.callCount, 1, "Did rerender");
		assert.ok(!oObjectStatus.$().children(".sapMObjStatusText").length, "Did not render the text span");
		assert.strictEqual(oObjectStatus.getText(), sTextToSet, "Did set the value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should rerender if the new title is empty", function(assert) {
		// Arrange
		var sTitleToSet = "  ",
			oRenderSpy,
			oResult,
			oConstructor = { title : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setTitle(sTitleToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oRenderSpy.callCount, 1, "Did rerender");
		assert.ok(!oObjectStatus.$().children(".sapMObjStatusTitle").length, "Did not render the title span");
		assert.strictEqual(oObjectStatus.getTitle(), sTitleToSet, "Did set the value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should rerender if the new text is undefined", function(assert) {
		// Arrange
		var sTextToSet = undefined,
			oRenderSpy,
			oResult,
			oConstructor = { text : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setText(sTextToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oRenderSpy.callCount, 1, "Did rerender");
		assert.ok(!oObjectStatus.$().children(".sapMObjStatusText").length, "Did not render the text span");
		assert.strictEqual(oObjectStatus.getText(), "", "Did set the default value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should rerender if the new title is undefined", function(assert) {
		// Arrange
		var sTitleToSet = undefined,
			oRenderSpy,
			oResult,
			oConstructor = { title : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setTitle(sTitleToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oRenderSpy.callCount, 1, "Did rerender");
		assert.ok(!oObjectStatus.$().children(".sapMObjStatusTitle").length, "Did not render the title span");
		assert.strictEqual(oObjectStatus.getTitle(), "", "Did set the default value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should rerender if the text was empty before", function(assert) {
		// Arrange
		var sTextToSet = "not empty text",
			oRenderSpy,
			oResult,
			oConstructor = { text : ""};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setText(sTextToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oRenderSpy.callCount, 1, "Did rerender");
		assert.ok(oObjectStatus.$().children(".sapMObjStatusText").length, "Did render the text span");
		assert.strictEqual(oObjectStatus.getText(), sTextToSet, "Did set the value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should rerender if the title was empty before", function(assert) {
		// Arrange
		var sTitleToSet = "not empty text",
			oRenderSpy,
			oResult,
			oConstructor = { title : ""};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oRenderSpy = this.spy(oObjectStatus, "invalidate");

		// Act
		oResult = oObjectStatus.setTitle(sTitleToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oRenderSpy.callCount, 1, "Did rerender");
		assert.ok(oObjectStatus.$().children(".sapMObjStatusTitle").length, "Did render the title span");
		assert.strictEqual(oObjectStatus.getTitle(), sTitleToSet, "Did set the value");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should display titles with special characters correctly", function(assert) {
		// Arrange
		var sTitleToSet = "Account blocked - Blocked for payment",
			oRenderSpy,
			oResult,
			oConstructor = { title : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		// Act
		oResult = oObjectStatus.setTitle(sTitleToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oObjectStatus.getTitle(), sTitleToSet, "Did set the value");
		assert.ok(/.*Account blocked - Blocked for payment:.*/.test(oObjectStatus.$().children(".sapMObjStatusTitle").html()), "Did display dashed string correctly");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should display texts with special characters correctly", function(assert) {
		// Arrange
		var sTextToSet = "Account blocked - Blocked for payment",
			oRenderSpy,
			oResult,
			oConstructor = { text : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		// Act
		oResult = oObjectStatus.setText(sTextToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oObjectStatus.getText(), sTextToSet, "Did set the value");
		assert.ok(/.*Account blocked - Blocked for payment.*/.test(oObjectStatus.$().children(".sapMObjStatusText").html()), "Did display dashed string correctly");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Should display titles with special characters correctly", function(assert) {
		// Arrange
		var sTitleToSet = "Account blocked - Blocked for payment",
			oRenderSpy,
			oResult,
			oConstructor = { title : "not empty text"};

		// System under Test
		var oObjectStatus = new sap.m.ObjectStatus(oConstructor).placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		// Act
		oResult = oObjectStatus.setTitle(sTitleToSet);
		sap.ui.getCore().applyChanges();

		// Assert
		assert.strictEqual(oObjectStatus.getTitle(), sTitleToSet, "Did set the value");
		assert.ok(/.*Account blocked - Blocked for payment:.*/.test(oObjectStatus.$().children(".sapMObjStatusTitle").html()), "Did display dashed string correctly");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.module("Screen reader ARIA support");

	QUnit.test("Has the appropriate ARIA attributes", function (assert) {
		//Arange
		var oObjectStatus = new sap.m.ObjectStatus({text: "Success object status", state: sap.ui.core.ValueState.SUCCESS});
		oObjectStatus.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		//Act
		assert.ok(oObjectStatus.$().attr("aria-describedby") !== null, "aria-describedby attribute is present");
		assert.ok(oObjectStatus.$().children(":last-child").attr("aria-hidden") !== null, "hidden element has aria-hidden attribute");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("getAccessibilityInfo", function(assert) {
		var oControl = new sap.m.ObjectStatus({text: "Text", title: "Title", tooltip: "Tooltip"});
		assert.ok(!!oControl.getAccessibilityInfo, "ObjectStatus has a getAccessibilityInfo function");
		var oInfo = oControl.getAccessibilityInfo();
		assert.ok(!!oInfo, "getAccessibilityInfo returns a info object");
		assert.strictEqual(oInfo.role, undefined, "AriaRole");
		assert.strictEqual(oInfo.type, undefined, "Type");
		assert.strictEqual(oInfo.description, "Title Text  Tooltip", "Description");
		assert.strictEqual(oInfo.focusable, undefined, "Focusable");
		assert.strictEqual(oInfo.enabled, undefined, "Enabled");
		assert.strictEqual(oInfo.editable, undefined, "Editable");
		oControl.setState("Warning");
		oControl.setTitle("");
		oInfo = oControl.getAccessibilityInfo();
		assert.strictEqual(oInfo.description, "Text " + sap.ui.core.ValueStateSupport.getAdditionalText(oControl.getState()) + " " + oControl.getTooltip(), "Description");
		oControl.destroy();
	});

	QUnit.test("Active ObjectStatus has role 'link'", function(assert) {

		// Arrange
		var oObjectStatus = new sap.m.ObjectStatus({
			title: "Title",
			text: "Contract #D1234567890",
			active: true
		});

		// Act
		oObjectStatus.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		assert.equal(oObjectStatus.$().attr("role"), "link", "Active ObjectStatus has link role.");

		// Clean up
		oObjectStatus.destroy();

	});

	QUnit.module("textDirection");

	QUnit.test("Title and Text has dir set to LTR when Inherit", function (assert) {
		//Arange
		var oObjectStatus = new sap.m.ObjectStatus({title: "Staus", text: "Success object"});
		oObjectStatus.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		//Act
		assert.equal(oObjectStatus.$("title").attr("dir"), "ltr", "When the textDirection has the Inherit value, for the title is set LTR when on LTR page");
		assert.equal(oObjectStatus.$("text").attr("dir"), "ltr", "When the textDirection has the Inherit value, for the text is set LTR when on LTR page");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.test("Title and Text has dir set to RTL when textDirection=RTL", function (assert) {
		//Arange
		var oObjectStatus = new sap.m.ObjectStatus({title: "Staus", text: "Success object", textDirection: sap.ui.core.TextDirection.RTL});
		oObjectStatus.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		//Act
		assert.equal(oObjectStatus.$("title").attr("dir"), "rtl", "When textDirection=RTL, for the title is set also RTL");
		assert.equal(oObjectStatus.$("text").attr("dir"), "rtl", "When textDirection=RTL, for the text is set also RTL");

		//Cleanup
		oObjectStatus.destroy();
	});

	QUnit.module("Active status", {
		beforeEach: function () {
			this.oActiveStat = new sap.m.ObjectStatus("oStatus", {
				title: "Title",
				text: "Contract #D1234567890",
				icon: "sap-icon://alert",
				active: true
			});
		},
		afterEach: function () {
			this.oActiveStat.destroy();
		}
	});


	QUnit.test("Active status has 'sapMObjStatusActive' class and icon and text are encapsulated in one span", function(assert) {
		this.oActiveStat.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		// assertions
		assert.ok(this.oActiveStat.$().hasClass("sapMObjStatusActive"), "Active status has sapMObjStatusActive class.");
		assert.ok(this.oActiveStat.$().children(1).hasClass("sapMObjStatusLink"), "The span that holds Icon and Text has class sapMObjStatusLink.");
		assert.strictEqual(this.oActiveStat.$().children().length, 2, "sapMObjStatusLink span has two children");
		assert.strictEqual(this.oActiveStat.$().children().children(".sapMObjStatusIcon").length, 1, "The icon span has class sapMObjStatusIcon.");
		assert.strictEqual(this.oActiveStat.$().children().children(".sapMObjStatusText").length, 1, "The text span has class sapMObjStatusText.");
	});

	QUnit.test("Active status with empty icon and text", function(assert) {
		this.oActiveStat.setText("");
		this.oActiveStat.setIcon("");
		this.oActiveStat.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		// assertions
		assert.ok(!this.oActiveStat.$().hasClass("sapMObjStatusActive"), "Active class is not set when there is no icon and text.");
		assert.ok(!this.oActiveStat.$().children().hasClass("sapMObjStatusLink"), "There is no class sapMObjStatusLink.");
	});

	QUnit.module("Private function _isClickable", {
		beforeEach: function () {
			this.oActiveStat = new sap.m.ObjectStatus("oStatus", {
				title: "Title",
				text: "Contract #D1234567890",
				icon: "sap-icon://alert",
				active: true
			});
			this.oActiveStat.placeAt("qunit-fixture");
			sap.ui.getCore().applyChanges();

			this.oStub = sinon.stub(sap.m.ObjectStatus.prototype, "_isActive");
		},
		afterEach: function () {
			this.oStub.restore();

			this.oActiveStat.destroy();
		}
	});

	QUnit.test("When _isActive is true and target click is on text", function(assert) {
		// Arrange
		var oEvent = new jQuery.Event();

		this.oStub.withArgs().returns(true);
		oEvent.target = this.oActiveStat.$().children().children(".sapMObjStatusText")[0];

		// Act
		assert.ok(this.oActiveStat._isClickable(oEvent), "The 'Status' is clickable");
	});

	QUnit.test("When _isActive is true and target click is on icon", function(assert) {
		// Arrange
		var oEvent = new jQuery.Event();

		this.oStub.withArgs().returns(true);
		oEvent.target = this.oActiveStat.$().children().children(".sapMObjStatusIcon")[0];

		// Act
		assert.ok(this.oActiveStat._isClickable(oEvent), "The 'Status' is clickable");
	});

	QUnit.test("When _isActive is true and target click is on wrapper IconText", function(assert) {
		// Arrange
		var oEvent = new jQuery.Event();

		this.oStub.withArgs().returns(true);
		oEvent.target = this.oActiveStat.$().children()[1];

		// Act
		assert.ok(this.oActiveStat._isClickable(oEvent), "The 'Status' is clickable");
	});

	QUnit.test("When _isActive is false", function(assert) {
		// Arrange
		var oEvent = new jQuery.Event();

		this.oStub.withArgs().returns(false);
		oEvent.target = this.oActiveStat.$().children().children(".sapMObjStatusText")[0];

		// Act
		assert.ok(!this.oActiveStat._isClickable(oEvent), "The 'Status' is not clickable");
	});


	QUnit.module("Events", {
		beforeEach: function () {
			this.oActiveStat = new sap.m.ObjectStatus("oStatus", {
				title: "Title",
				icon: "sap-icon://alert",
				text: "Contract #D1234567890",
				active: true,
				press: eventHandler
			});
		},
		afterEach: function () {
			this.oActiveStat.destroy();
		}
	});

	QUnit.test("press active ObjectStatus with text and icon", function(assert) {
		// Act
		this.oActiveStat.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		assert.expect(3);
		qutils.triggerEvent("tap", this.oActiveStat.$().children()[1]); // click on a wrapper IconText span, should fire event
		qutils.triggerEvent("tap", this.oActiveStat.$().children().children(".sapMObjStatusText")); //should fire event
		qutils.triggerEvent("tap", this.oActiveStat.$().children().children(".sapMObjStatusIcon")); //should fire event
		qutils.triggerEvent("tap", this.oActiveStat.$().children()[0]);//click on a title should not fire event
	});

	QUnit.test("press title of active ObjectStatus with no text and icon should not fire event", function(assert) {
		this.oActiveStat.setText("");
		this.oActiveStat.setIcon("");

		// Act
		this.oActiveStat.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		assert.expect(0);
		qutils.triggerEvent("tap", this.oActiveStat.$().children()[0]);//click on a title should not fire event
	});


	QUnit.test("ObjectStatus marks the Event on touchstart", function(assert) {
		// Arrange
		var oEvent = new jQuery.Event();

		// Act
		this.oActiveStat.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		oEvent.target = this.oActiveStat.$().children().children(".sapMObjStatusText")[0];
		this.oActiveStat.ontouchstart(oEvent);

		assert.strictEqual(oEvent.getMark(), true, "Event was marked so the parent control will know that it will be handled by the ObjectStatus");
	});

	QUnit.module("Keyboard handling");

	QUnit.test("Enter", function(assert) {

		// Arrange
		var oObjectStatus = new sap.m.ObjectStatus({
			title: "Title",
			text: "Contract #D1234567890",
			active: true
		});

		// Act
		oObjectStatus.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		var oPressSpy = sinon.spy(sap.m.ObjectStatus.prototype, "firePress");
		sap.ui.test.qunit.triggerKeydown(oObjectStatus.getFocusDomRef(), jQuery.sap.KeyCodes.ENTER);

		assert.strictEqual(oPressSpy.callCount, 1, "Enter is pressed, press event was fired");

		// Clean up
		sap.m.ObjectStatus.prototype.firePress.restore();
		oObjectStatus.destroy();
	});

	QUnit.test("Space", function(assert) {

		// Arrange
		var oObjectStatus = new sap.m.ObjectStatus({
			title: "Title",
			text: "Contract #D1234567890",
			active: true
		});

		// Act
		oObjectStatus.placeAt("qunit-fixture");
		sap.ui.getCore().applyChanges();

		var oPressSpy = sinon.spy(sap.m.ObjectStatus.prototype, "firePress");
		sap.ui.test.qunit.triggerKeydown(oObjectStatus.getFocusDomRef(), jQuery.sap.KeyCodes.SPACE);

		assert.strictEqual(oPressSpy.callCount, 1, "Space is pressed, press event was fired");

		// Clean up
		sap.m.ObjectStatus.prototype.firePress.restore();
		oObjectStatus.destroy();
	});
</script>
</head>

<body class="sapUiBody">
	<div id="qunit"></div>
	<div id="objectStatuses"></div>
	<div id="qunit-fixture"></div>
</body>
</html>
